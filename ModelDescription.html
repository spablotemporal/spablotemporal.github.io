<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Model Description</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Jose Pablo Gomez-Vazquez</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Research.html">About Me</a>
</li>
<li>
  <a href="CV.html">CV</a>
</li>
<li>
  <a href="Training.html">Training</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Contact
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://github.com/jpablo91">
        <span class="fa fa-github"></span>
         
      </a>
    </li>
    <li>
      <a href="https://www.linkedin.com/in/pablo-gomez-v-b19553129/">
        <span class="fa fa-linkedin"></span>
         
      </a>
    </li>
    <li>
      <a href="mailto:jpgo@ucdavis.edu">
        <span class="fa fa-envelope"></span>
         
      </a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Model Description</h1>

</div>


<p>Our model is an adaptation of another model developed by the research group of Richard Neher from the university of Basel.</p>
<p>The model consists on a compartmental extended SIR model, where the population is break down in multiple compartments stratified by age group and condition (having Smoking, diabetes or hearth disease vs none). The population of the county (<span class="math inline">\(N\)</span>) is distributed between the estimations for each of the stratification groups (<span class="math inline">\(N_i\)</span>), the proportion of the population for each group was estimated using the CHIS census.</p>
<p><img src="Images/COVIDModel/StratTable.png" width="50%" style="display: block; margin: auto;" /></p>
<p>The flow of the population among the compartments goes as follows:</p>
<p><img src="Images/COVIDModel/Model.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Where the subscript <span class="math inline">\(i\)</span> indicates each of the stratification groups, and the compartments represent:</p>
<ul>
<li>Susceptible (<span class="math inline">\(S\)</span>), population that is susceptible for the infection (in this model we assume that everyone in the county are susceptible, N = 550,000).</li>
<li>Exposed (<span class="math inline">\(E\)</span>). The transition from exposed to infectious is divided into 3 stages (E1, E2, E3).</li>
<li>Infected (<span class="math inline">\(I\)</span>). The infectious segment of the populations.</li>
<li>Hospitalized (<span class="math inline">\(H\)</span>). The sick individuals that had to be hospitalized.</li>
<li>Intensive Care Unit (<span class="math inline">\(C\)</span>). The individuals that had to be at intensive care unit.</li>
<li>Death (<span class="math inline">\(D\)</span>). The individuals that died from the disease.</li>
</ul>
<p>The change between compartments is given by the following equations:</p>
<p><span class="math display">\[ \begin{split}
\frac{dS_i}{dt} &amp;=  - \frac{\beta_i(t)S_iI}{N} + \frac{m_i}{N_i} \  \text{(Change in Susceptible)} \\ 
\frac{dE1_i}{dt} &amp;= \frac{\beta_i(t)S_iI}{N} - t_{l}^{-1}3E1_i \  \text{(Change in Exposed 1)}\\
\frac{dE2_i}{dt} &amp;= t_{l}^{-1}3E1_i - t_{l}^{-1}3E2_i \  \text{(Change in Exposed 2)} \\
\frac{dE3_i}{dt} &amp;= t_{l}^{-1}3E2_i - t_{l}^{-1}3E3_i \  \text{(Change in Exposed 3)} \\
\frac{dI_i}{dt} &amp;= t_{l}^{-1}3E1_i - t_I^{-1}\delta_iI_i  - t_I^{-1}\gamma_iI \  \text{(Change in Infected)}\\
\frac{dH_i}{dt} &amp;= t_I^{-1}\delta_iI_i + t_{c}^{-1}\bar{\omega_i}H - t_{h}^{-1}\zeta_iH - t_{h}^{-1}\bar{\zeta_i}H\  \text{(Change in Hospitalized)} \\
\frac{dC_i}{dt} &amp;= t_{h}^{-1}\zeta_iH - t_{c}^{-1}\omega_iH -  t_{c}^{-1}\bar{\omega_i}H \  \text{(Change in ICU)} \\
\frac{dR_i}{dt} &amp;= \gamma_iI + t_{h}^{-1}\bar{\zeta_i}H \  \text{(Change in Deaths)}
\end{split}
\]</span></p>
<p>Parameters (indicated with the <span class="math inline">\(i\)</span> subscript) were calculated for each of the stratification groups based on the observed hospitalization rates by age and condition reported by the CDC (<a href="https://www.cdc.gov/mmwr/volumes/69/wr/pdfs/mm6915e3-H.pdf" class="uri">https://www.cdc.gov/mmwr/volumes/69/wr/pdfs/mm6915e3-H.pdf</a>) . Parameters <span class="math inline">\(t^{-1}\)</span>, represent the inverse of the average number of days the individuals spend on each of the compartments (<span class="math inline">\(t_l\)</span> = latency period, <span class="math inline">\(t_I\)</span> = infectious period, <span class="math inline">\(t_h\)</span> = days at the hospital, <span class="math inline">\(t_c\)</span> = days at ICU). Detailed information of the parameters can be found on the following table.</p>
<ul>
<li>All the parameters were estimated based on National statistics, it is important to note that the disease dynamic might have a different behavior in the county</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">Symbol</th>
<th align="left">Name of parameter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(m_i\)</span></td>
<td align="left">Imports per day</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\delta_i\)</span></td>
<td align="left">Probability of Hospitalization</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\gamma_i\)</span></td>
<td align="left">Probability of Recovery from Infection</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\zeta_i\)</span></td>
<td align="left">Probability of moving to ICU</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\omega\)</span></td>
<td align="left">Probability of dying</td>
</tr>
</tbody>
</table>
<div id="estimation-of-beta_i" class="section level1">
<h1>Estimation of <span class="math inline">\(\beta_i\)</span></h1>
<p>The <span class="math inline">\(\beta_i\)</span> parameter is a time dependent estimation based on the <span class="math inline">\(R_e\)</span>, the effect of interventions and the seasonality.</p>
<div id="effective-reproduction-number-rt" class="section level3">
<h3>Effective reproduction number (Rt)</h3>
<p><img src="Images/COVIDModel/Rt.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="interventions" class="section level3">
<h3>Interventions</h3>
<p>The interventions can be applied to a time frame with an effect that is assumed to be constant over the time the intervention was applied.<br />
The transmission parameter (<span class="math inline">\(\beta_I\)</span>) is scaed by the effect (<span class="math inline">\(\phi\)</span>)of intervention as follows: <span class="math inline">\(\beta_i(t) = R_e\phi M(t)\)</span></p>
</div>
<div id="seasonal-effect." class="section level3">
<h3>Seasonal effect.</h3>
<p>The seasonal variation is based on a function where the seasonal peak is modeled based on a sinusoidal function with an annual period. The model allows to specify the seasonal peak and the force of the seasonality.</p>
<p><span class="math inline">\(\beta_i(t) = R_e(1+\epsilon \cos(2\pi(t-t_{peak})))/365\)</span></p>
<p><img src="Images/COVIDModel/Seasonality.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="go-back-to-the-app" class="section level3">
<h3><a href="https://jpablo91.shinyapps.io/StanTest/">Go back to the app</a></h3>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
